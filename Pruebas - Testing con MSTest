using Microsoft.VisualStudio.TestTools.UnitTesting;
using Proyecto_Estructura;
using System;

namespace Prueba_de_proyecto
{
    [TestClass]
    public class UnitTest1
    {
        //Verificación de que se pueda agregar un interés válido a un usuario y que si quede en la lista de intereses
        [TestMethod]
        public void AgregarIntereses()
        {
            Usuario user = new Usuario("Gabriela");
            user.AgregarIntereses("Música");
            CollectionAssert.Contains(new System.Collections.Generic.List<string>(user.Intereses), "Música");
        }
        //Verificación de que al crear el usuario el nombre quede correctamente ingresado
        [TestMethod]
        public void CrearUsuario()
        {
            Usuario user = new Usuario("Ana");
            Assert.AreEqual("Ana", user.Nombre);
        }
        //Verificación de que no se agreguen intereses duplicados
        [TestMethod]
        public void NoDuplicado_Excepcion()
        {
            Usuario user = new Usuario("Pedro");
            user.AgregarIntereses("Deporte");

            Assert.ThrowsException<InvalidOperationException>(() => user.AgregarIntereses("Deporte"));
        }
        //Verificación de que no se agreguen intereses vacíos o en blanco
        [TestMethod]
        public void NoAgregarVacios_Excepcion()
        {
            Usuario user = new Usuario("Laura");
            Assert.ThrowsException<ArgumentException>(() => user.AgregarIntereses(""));
            Assert.ThrowsException<ArgumentException>(() => user.AgregarIntereses("   "));
        }
    }

    [TestClass]
    public class UsuarioTests
    {
        [TestMethod]
        public void AgregarInteresValido()
        {
            Usuario user = new Usuario("Gabriela");
            user.AgregarIntereses("Música");
            Assert.IsTrue(user.Intereses.Contains("Música"));
        }

        [TestMethod]
        [ExpectedException(typeof(ArgumentException))]
        public void AgregarInteresVacio()
        {
            Usuario user = new Usuario("Lola");
            user.AgregarIntereses("");
        }

        [TestMethod]
        [ExpectedException(typeof(InvalidOperationException))]
        public void AgregarInteresRepetido()
        {
            Usuario user = new Usuario("Carlos");
            user.AgregarIntereses("Arte");
            user.AgregarIntereses("Arte");
        }
    }

