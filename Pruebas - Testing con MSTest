using Microsoft.VisualStudio.TestTools.UnitTesting;
using Proyecto_Estructura;
using System;

namespace Prueba_de_proyecto
{
 
    [TestClass]
    public class UsuarioTests
    {
        [TestMethod]
        //Aqui se verifica que un interés se agrega correctamente al usuario
        public void AgregarIntereses()
        {
            Usuario user = new Usuario("Gabriela");
            user.AgregarIntereses("Música");
            Assert.IsTrue(user.Intereses.Contains("Música"));
        }

        [TestMethod]
        [ExpectedException(typeof(ArgumentException))]
        //Se verifica que no se agregue un interés vacío o en blancco
        public void AgregarInteresVacio()
        {
            Usuario user = new Usuario("Lola");
            user.AgregarIntereses("");
        }
        [TestMethod]
        [ExpectedException(typeof(InvalidOperationException))]

        //No se permite agregar intereses repetidos
        public void AgregarInteresRepetido()
        {
            Usuario user = new Usuario("Carlos");
            user.AgregarIntereses("Arte");
            user.AgregarIntereses("Arte");
        }

        [TestMethod]
        //Áqui se verifica que se cree el usuario correctamente
        public void CrearUsuario()
        {
            Usuario user = new Usuario("Ana");
            Assert.AreEqual("Ana", user.Nombre);
        }

        [TestMethod]
        //Esta es una excepción para que no haya duplicados
        public void NoDuplicadoExcepcion()
        {
            Usuario user = new Usuario("Pedro");
            user.AgregarIntereses("Deporte");

            Assert.ThrowsException<InvalidOperationException>(() => user.AgregarIntereses("Deporte"));
        }

        [TestMethod]
        //Excepción para que no haya vacíos o espacios en blanco
        public void NoAgregarVaciosExcepcion()
        {
            Usuario user = new Usuario("Laura");
            Assert.ThrowsException<ArgumentException>(() => user.AgregarIntereses(""));
            Assert.ThrowsException<ArgumentException>(() => user.AgregarIntereses("   "));
        }
    }


    [TestClass]
    public class GrafosTests
    {
        [TestMethod]
        /* se verifica que las conexiones entre usuario
        se generen correctamente */
        public void GenerarConexiones()
        {
            var grafo = new GrafosUsuarios();

            var violeta = new Usuario("Violeta");
            violeta.AgregarIntereses("Música");
            violeta.AgregarIntereses("Películas");

            var marta = new Usuario("Marta");
            marta.AgregarIntereses("Música");
            marta.AgregarIntereses("Deporte");

            grafo.AgregarUsuario(violeta);
            grafo.AgregarUsuario(marta);

            grafo.GenerarConexiones();

            Assert.AreEqual(2, grafo.CantidadUsuarios);
        }

        [TestMethod]
        /* se verifica que BFS recorra todos
        /los nodos conectados */
        public void BFS()
        {
            var grafo = new GrafosUsuarios();
            var violeta = new Usuario("Violeta");
            var ana = new Usuario("Ana");
            var marta = new Usuario("Marta");

            violeta.AgregarIntereses("Música");
            ana.AgregarIntereses("Música");
            marta.AgregarIntereses("Música");

            grafo.AgregarUsuario(violeta);
            grafo.AgregarUsuario(ana);
            grafo.AgregarUsuario(marta);
            grafo.GenerarConexiones();
        }

        [TestMethod]
        //verifica que no dé un error cuando no haya usuarios
        public void GenerarConexionesVacio()
        {
            var grafo = new GrafosUsuarios();
            grafo.GenerarConexiones();
            Assert.AreEqual(0, grafo.CantidadUsuarios);
        }

        [TestMethod]
        //Verifica que se agregue un usuario correctamente
        public void AgregarUsuarioCorrecto()
        {
            var grafo = new GrafosUsuarios();
            var user = new Usuario("Mario");

            grafo.AgregarUsuario(user);

            Assert.AreEqual(1, grafo.CantidadUsuarios);
        }
    }
}
